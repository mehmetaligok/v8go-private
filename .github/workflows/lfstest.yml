name: LFS test

on:
  workflow_dispatch:
  push:

jobs:
  lfs-test:
    name: Push dummy lfs file
    strategy:
      fail-fast: false
      matrix:
        platform: [ ubuntu-22.04 ]
        arch: [ x86_64 ]
    runs-on: ${{ matrix.platform }}
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          submodules: true
          fetch-depth: 0
      - name: Create LFS tracked file
        run: |
          git lfs track "lfstest/*.json"
          date +%s > lfstest/dummy.json
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v7
        with:
          commit-message: Update V8 static library for ${{ matrix.platform }} ${{ matrix.arch }}
          branch-suffix: random
          delete-branch: true
          title: V8 static library for ${{ matrix.platform }} ${{ matrix.arch }}
          body: Auto-generated pull request to build V8 for ${{ matrix.platform }} ${{ matrix.arch }}